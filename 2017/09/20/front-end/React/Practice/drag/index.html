<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.2">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"vonxq.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"appID":"3L870LDMUT","apiKey":"8b6efb02212c0f610f3f05c910cb208e","indexName":"vonxq","hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="article">
<meta property="og:title" content="使用react-dnd+antd tree实现两个列表的拖拽数据传递">
<meta property="og:url" content="https://vonxq.github.io/2017/09/20/front-end/React/Practice/drag/index.html">
<meta property="og:site_name" content="vonxq">
<meta property="og:locale">
<meta property="og:image" content="https://github.com/vonxq/TreeDragDemo/raw/master/img/dragDemo.gif">
<meta property="article:published_time" content="2017-09-20T11:21:13.000Z">
<meta property="article:modified_time" content="2022-05-30T07:00:16.589Z">
<meta property="article:author" content="vonxq">
<meta property="article:tag" content="React">
<meta property="article:tag" content="Drag-dnd">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://github.com/vonxq/TreeDragDemo/raw/master/img/dragDemo.gif">

<link rel="canonical" href="https://vonxq.github.io/2017/09/20/front-end/React/Practice/drag/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-Hans'
  };
</script>

  <title>使用react-dnd+antd tree实现两个列表的拖拽数据传递 | vonxq</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">vonxq</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">less is more</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://vonxq.github.io/2017/09/20/front-end/React/Practice/drag/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="vonxq">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="vonxq">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          使用react-dnd+antd tree实现两个列表的拖拽数据传递
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-09-20 19:21:13" itemprop="dateCreated datePublished" datetime="2017-09-20T19:21:13+08:00">2017-09-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-05-30 15:00:16" itemprop="dateModified" datetime="2022-05-30T15:00:16+08:00">2022-05-30</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Frontend/" itemprop="url" rel="index"><span itemprop="name">Frontend</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Frontend/React/" itemprop="url" rel="index"><span itemprop="name">React</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Frontend/React/Practice/" itemprop="url" rel="index"><span itemprop="name">Practice</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p><img src="https://github.com/vonxq/TreeDragDemo/raw/master/img/dragDemo.gif"></p>
<span id="more"></span>

<h1 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h1><p>项目内需要用到将已有Tree形式数据组织排列到新的Tree中，新的Tree可动态增删(现在还没实现删除功能)，还可以动态地改变Tree排序方式<br>主要实现以下功能：<br>DragSource可拖拽到DragTarget中，DragTarget动态添加节点(React-dnd实现)<br>DragTraget可实现拖拽排序功能(antd tree实现)</p>
<h2 id="源码地址"><a href="#源码地址" class="headerlink" title="源码地址"></a>源码地址</h2><p><a target="_blank" rel="noopener" href="https://github.com/vonxq/TreeDragDemo">https://github.com/vonxq/TreeDragDemo</a></p>
<h2 id="使用工具"><a href="#使用工具" class="headerlink" title="使用工具:"></a>使用工具:</h2><ol>
<li>react-dnd + antd(tree组件)</li>
<li>create-react-app</li>
</ol>
<h1 id="实现详解"><a href="#实现详解" class="headerlink" title="实现详解"></a>实现详解</h1><p><a target="_blank" rel="noopener" href="https://github.com/react-dnd/react-dnd">react-dnd</a>是一个开源的拖拽实现源码，之前也调研过<a target="_blank" rel="noopener" href="https://github.com/atlassian/react-beautiful-dnd">react-beautiful-dnd</a>，但这个好像功能较少，最后还是选择了react-dnd</p>
<p>antd是阿里的react组件库，主要是我懒，就用了现成的可拖拽Tree，Tree好像不能实现两个Tree之间的拖拽传递，我试着做了下，但Tree并不能识别不是自己tree的drag节点(key标识)信息，这应该跟底层源码实现有关，估计是被规避了，不想折腾最后两个组件之间的拖拽传递就采用了react-dnd来做</p>
<h2 id="React-dnd的使用"><a href="#React-dnd的使用" class="headerlink" title="React-dnd的使用"></a>React-dnd的使用</h2><p>react-dnd有个官方的实例,效果可以<a target="_blank" rel="noopener" href="http://react-dnd.github.io/react-dnd/examples-chessboard-tutorial-app.html">点击查看</a><br>具体实现过程<a target="_blank" rel="noopener" href="http://react-dnd.github.io/react-dnd/docs-tutorial.html">点击查看</a><br>看官方实例再对照API感觉会清晰很多，官方讲解全是英文，自己看得也很吃力，所以说英语还是很重要啊。反正不管怎样，最后这个功能也实现了，最好的学习方式就是示例源码对照着API，很容易理解。</p>
<h3 id="DragSource"><a href="#DragSource" class="headerlink" title="DragSource"></a>DragSource</h3><p>基础用法:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">DragSource</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-dnd&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyComponent</span> &#123;</span><br><span class="line">  <span class="comment">/* ... */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">DragSource</span>(type, spec, collect)(<span class="title class_">MyComponent</span>);</span><br></pre></td></tr></table></figure>
<h4 id="参数讲解"><a href="#参数讲解" class="headerlink" title="参数讲解:"></a>参数讲解:</h4><blockquote>
<p>type: Required. Either a string, an ES6 symbol, or a function that returns either given the component’s props. Only the drop targets registered for the same type will react to the items produced by this drag source. Read the overview to learn more about the items and types.</p>
</blockquote>
<blockquote>
<p>spec: Required. A plain JavaScript object with a few allowed methods on it. It describes how the drag source reacts to the drag and drop events. See the drag source specification described in detail in the next section.</p>
</blockquote>
<blockquote>
<p>collect: Required. The collecting function. It should return a plain object of the props to inject into your component. It receives two parameters: connect and monitor. Read the overview for an introduction to the monitors, the connectors, and the collecting function. See the collecting function described in detail after the next section.</p>
</blockquote>
<blockquote>
<p>options: Optional. A plain object. If some of the props to your component are not scalar (that is, are not primitive values or functions), specifying a custom arePropsEqual(props, otherProps) function inside the options object can improve the performance. Unless you have performance problems, don’t worry about it.</p>
</blockquote>
<h4 id="type"><a href="#type" class="headerlink" title="type"></a><span id='type'>type</span></h4><p>必要的。很好懂，类似namespace的概念，只有type相同的DragSource和DragTarget能相互识别</p>
<h4 id="spec"><a href="#spec" class="headerlink" title="spec"></a><span id='spec'>spec</span></h4><p>必要的。就是一个对象，定义了几个函数，我做的功能只用到了第一个函数</p>
<h5 id="参数讲解："><a href="#参数讲解：" class="headerlink" title="参数讲解："></a>参数讲解：</h5><blockquote>
<p>props: Your component’s current props.<br>monitor: 可以使用getItem()来得到具体的值。<br>  An instance of DragSourceMonitor. Use it to query the information about the current drag state, such as the currently dragged item and its type, the current and initial coordinates and offsets, and whether it was dropped yet. Read the DragSourceMonitor documentation for a complete list of monitor methods, or read the overview for an introduction to the monitors.<br>component: 就是组件句柄，相当于this，可以用这个调用其内部函数。<br>  When specified, it is the instance of your component. Use it to access the underlying DOM node for position or size measurements, or to call setState, and other component methods. It is purposefully missing from isDragging and canDrag because the instance may not be available by the time they are called. If you want these methods to depend on the component’s state, consider lifting the state to the parent component, so that you can just use props. Generally your code will be cleaner if you rely on props instead whenever possible.</p>
</blockquote>
<h5 id="具体可用方法"><a href="#具体可用方法" class="headerlink" title="具体可用方法:"></a>具体可用方法:</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> spec = &#123;</span><br><span class="line">  <span class="comment">// 此函数返回一个对象，这个对象用于描述此被draf对象，可在DragTarget的spec的drop方法中通过monitor.getItem()得到</span></span><br><span class="line">  <span class="title function_">beginDrag</span>(<span class="params">props, monitor, component</span>)&#123;&#125;<span class="comment">// Required. When the dragging starts, beginDrag is called. You must return a plain JavaScript object describing the data being dragged. What you return is the only information available to the drop targets about the drag source so it&#x27;s important to pick the minimal data they need to know. You may be tempted to put a reference to the component into it, but you should try very hard to avoid doing this because it couples the drag sources and drop targets. It&#x27;s a good idea to return something like &#123; id: props.id &#125; from this method.</span></span><br><span class="line">  <span class="title function_">endDrag</span>(<span class="params">props, monitor, component</span>)&#123;&#125;<span class="comment">// Optional. When the dragging stops, endDrag is called. For every beginDrag call, a corresponding endDrag call is guaranteed. You may call monitor.didDrop() to check whether or not the drop was handled by a compatible drop target. If it was handled, and the drop target specified a drop result by returning a plain object from its drop() method, it will be available as monitor.getDropResult(). This method is a good place to fire a Flux action. Note: If the component is unmounted while dragging, component parameter is set to be null.</span></span><br><span class="line"></span><br><span class="line">  <span class="title function_">canDrag</span>(<span class="params">props, monitor</span>)&#123;&#125;<span class="comment">//Optional. Use it to specify whether the dragging is currently allowed. If you want to always allow it, just omit this method. Specifying it is handy if you&#x27;d like to disable dragging based on some predicate over props. Note: You may not call monitor.canDrag() inside this method.</span></span><br><span class="line"></span><br><span class="line">  <span class="title function_">isDragging</span>(<span class="params">props, monitor</span>)&#123;&#125;<span class="comment">//Optional. By default, only the drag source that initiated the drag operation is considered to be dragging. You can override this behavior by defining a custom isDragging method. It might return something like props.id === monitor.getItem().id. Do this if the original component may be unmounted during the dragging and later “resurrected” with a different parent. For example, when moving a card across the lists in a Kanban board, you want it to retain the dragged appearance—even though technically, the component gets unmounted and a different one gets mounted every time you move it to another list. Note: You may not call monitor.isDragging() inside this method.</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="collect"><a href="#collect" class="headerlink" title="collect"></a><span id='collect'>collect</span></h4><p>必要的,此方法返回一个对象，这个对象会被注入到组件的props中<br>主要做两件事：</p>
<ol>
<li>connect the React DnD event handlers to some node in the component;</li>
<li>pass some knowledge about the dragging state to our component.<br>至少需要返回connect.dragSource()方法，让组件可以将自己连接起来，从而可以被拖拽及响应拖拽<h5 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">collect</span> (connect, monitor) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">connectDragSource</span>: connect.<span class="title function_">dragSource</span>(),</span><br><span class="line">    <span class="attr">isDragging</span>: monitor.<span class="title function_">isDragging</span>()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 组件中应用</span></span><br><span class="line">render () &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; connectDragSource, isDragging, value &#125; = <span class="variable language_">this</span>.<span class="property">props</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">connectDragSource</span>(</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">float:</span> &quot;<span class="attr">left</span>&quot;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">opacity:</span> <span class="attr">isDragging</span> ? <span class="attr">0.5</span> <span class="attr">:</span> <span class="attr">1</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">cursor:</span> <span class="attr">isDragging</span> ? &#x27;<span class="attr">move</span>&#x27;<span class="attr">:</span> &#x27;&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">Icon</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">marginRight:</span> &#x27;<span class="attr">5px</span>&#x27; &#125;&#125; <span class="attr">type</span>=<span class="string">&quot;folder-open&quot;</span> /&gt;</span>&#123;value.title&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="options"><a href="#options" class="headerlink" title="options"></a>options</h4><p>本项目没具体用到，有需要再看API吧</p>
<h3 id="DropTarget"><a href="#DropTarget" class="headerlink" title="DropTarget"></a>DropTarget</h3><p>老是写成DragTarget…<br>基本用法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">DropTarget</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-dnd&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyComponent</span> &#123;</span><br><span class="line">  <span class="comment">/* ... */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">DropTarget</span>(types, spec, collect)(<span class="title class_">MyComponent</span>);</span><br></pre></td></tr></table></figure>
<p>参数讲解:</p>
<blockquote>
<p>types: Required. A string, an ES6 symbol, an array of either, or a function that returns either of those, given component’s props. This drop target will only react to the items produced by the drag sources of the specified type or types. Read the overview to learn more about the items and types.</p>
</blockquote>
<blockquote>
<p>spec: Required. A plain JavaScript object with a few allowed methods on it. It describes how the drop target reacts to the drag and drop events. See the drop target specification described in detail in the next section.</p>
</blockquote>
<blockquote>
<p>collect: Required. The collecting function. It should return a plain object of the props to inject into your component. It receives two parameters: connect and monitor. Read the overview for an introduction to the monitors, the connectors, and the collecting function. See the collecting function described in detail after the next section.</p>
</blockquote>
<blockquote>
<p>options: Optional. A plain object. If some of the props to your component are not scalar (that is, are not primitive values or functions), specifying a custom arePropsEqual(props, otherProps) function inside the options object can improve the performance. Unless you have performance problems, don’t worry about it.</p>
</blockquote>
<h4 id="types"><a href="#types" class="headerlink" title="types"></a>types</h4><p>必要的，基本同<a href="#type">上面的type</a>,只是还可以是多个type的数组，也就是能接收多个来源</p>
<h4 id="spec-1"><a href="#spec-1" class="headerlink" title="spec"></a>spec</h4><p>必要的，就是一些回调<br>参数讲解</p>
<blockquote>
<p>props: Your component’s current props.<br>monitor: 可以使用getItem()来得到刚才在DragSource spec的beginDrag()中返回的对象。An instance of DropTargetMonitor. Use it to query the information about the current drag state, such as the currently dragged item and its type, the current and initial coordinates and offsets, whether it is over the current target, and whether it can be dropped. Read the DropTargetMonitor documentation for a complete list of monitor methods, or read the overview for an introduction to the monitors.<br>component: When specified, it is the instance of your component. Use it to access the underlying DOM node for position or size measurements, or to call setState, and other component methods. It is purposefully missing from canDrop because the instance may not be available by the time it is called. If you want this method to depend on the component’s state, consider lifting the state to the parent component, so that you can just use props. Generally your code will be cleaner if you rely on props instead whenever possible. Do note this is always null when hovering stateless components.</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  可以使用getItem()来得到刚才在DragSource spec的beginDrag()中返回的对象</span></span><br><span class="line"><span class="comment">// component可以调用组件内部方法</span></span><br><span class="line"><span class="title function_">drop</span>(<span class="params">props, monitor, component</span>)&#123;&#125;<span class="comment">// Optional. Called when a compatible item is dropped on the target. You may either return undefined, or a plain object. If you return an object, it is going to become the drop result and will be available to the drag source in its endDrag method as monitor.getDropResult(). This is useful in case you want to perform different actions depending on which target received the drop. If you have nested drop targets, you can test whether a nested target has already handled drop by checking monitor.didDrop() and monitor.getDropResult(). Both this method and the source&#x27;s endDrag method are good places to fire Flux actions. This method will not be called if canDrop() is defined and returns false.</span></span><br><span class="line"><span class="title function_">hover</span>(<span class="params">props, monitor, component</span>)&#123;&#125;<span class="comment">// Optional. Called when an item is hovered over the component. You can check monitor.isOver(&#123; shallow: true &#125;) to test whether the hover happens over just the current target, or over a nested one. Unlike drop(), this method will be called even if canDrop() is defined and returns false. You can check monitor.canDrop() to test whether this is the case.</span></span><br><span class="line"><span class="title function_">canDrop</span>(<span class="params">props, monitor</span>)&#123;&#125;<span class="comment">// Optional. Use it to specify whether the drop target is able to accept the item. If you want to always allow it, just omit this method. Specifying it is handy if you&#x27;d like to disable dropping based on some predicate over props or monitor.getItem(). Note: You may not call monitor.canDrop() inside this method.</span></span><br></pre></td></tr></table></figure>

<h2 id="tips"><a href="#tips" class="headerlink" title="tips"></a>tips</h2><p>react-dnd的dragSource和dropTraget可以是同一个组件，这种情况一般都是针对单个列表进行操作<br>具体实现可参考github上的<a target="_blank" rel="noopener" href="https://github.com/MarshalW/react-sortable.git">react-sortable</a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">DragSource</span>(type, itemSource, collectSource)(<span class="title class_">DropTarget</span>(type,itemTarget,collectTaget)(<span class="title class_">Item</span>))</span><br></pre></td></tr></table></figure>

<h2 id="Antd-Tree的排序实现"><a href="#Antd-Tree的排序实现" class="headerlink" title="Antd Tree的排序实现"></a>Antd Tree的排序实现</h2><p>这个其实在Antd上有实例代码，我也没做什么大的改动，直接上源码吧,DragT是实现了Tree的动态拖动排序的，具体功能注释中有</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Card</span>, <span class="title class_">Tree</span>, <span class="title class_">Icon</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">DropTarget</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-dnd&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">PropTypes</span> <span class="keyword">from</span> <span class="string">&#x27;prop-types&#x27;</span></span><br><span class="line"><span class="keyword">const</span>  <span class="title class_">TreeNode</span> = <span class="title class_">Tree</span>.<span class="property">TreeNode</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DragT</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span> (props) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">selectedKey</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">      <span class="attr">treeContent</span>: [],</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  onDragEnter = <span class="function">(<span class="params">info</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(info)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 遍历数组,找出key值与之相同的对象(节点)，执行callback函数</span></span><br><span class="line">  <span class="comment">// 若key值不匹配且含有children，则循环遍历</span></span><br><span class="line">  <span class="comment">// 否则不执行任何操作</span></span><br><span class="line"> loop = <span class="function">(<span class="params">data, key, callback</span>) =&gt;</span> &#123;</span><br><span class="line">    data.<span class="title function_">forEach</span>(<span class="function">(<span class="params">item, index, arr</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (item.<span class="property">key</span> === key) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">callback</span>(item, index, arr)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (item.<span class="property">children</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">loop</span>(item.<span class="property">children</span>, key, callback)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  onDrop = <span class="function">(<span class="params">info</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// console.log(info)</span></span><br><span class="line">    <span class="keyword">const</span> dropKey = info.<span class="property">node</span>.<span class="property">props</span>.<span class="property">eventKey</span></span><br><span class="line">    <span class="keyword">const</span> dragKey = info.<span class="property">dragNode</span>.<span class="property">props</span>.<span class="property">eventKey</span></span><br><span class="line">    <span class="keyword">const</span> data = <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">treeContent</span></span><br><span class="line">    <span class="keyword">let</span> dragObj</span><br><span class="line">    <span class="comment">// 保存节点信息并删除节点</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">loop</span>(data, dragKey, <span class="function">(<span class="params">item, index, arr</span>) =&gt;</span> &#123;</span><br><span class="line">      arr.<span class="title function_">splice</span>(index, <span class="number">1</span>)</span><br><span class="line">      dragObj = item</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// 将节点插入到正确位置</span></span><br><span class="line">    <span class="keyword">if</span> (info.<span class="property">dropToGap</span>) &#123;</span><br><span class="line">      <span class="keyword">let</span> ar</span><br><span class="line">      <span class="keyword">let</span> i</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">loop</span>(data, dropKey, <span class="function">(<span class="params">item, index, arr</span>) =&gt;</span> &#123;</span><br><span class="line">        ar.<span class="title function_">splice</span>(i, <span class="number">0</span>, dragObj)        </span><br><span class="line">      &#125;)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">loop</span>(data, dropKey, <span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">        item.<span class="property">children</span> = item.<span class="property">children</span> || []</span><br><span class="line">        <span class="comment">// where to insert 示例添加到尾部，可以是随意位置</span></span><br><span class="line">        item.<span class="property">children</span>.<span class="title function_">push</span>(dragObj)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      <span class="attr">treeContent</span>: data,</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  onNodeSelect = <span class="function">(<span class="params">selectedKeys, e</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;select&#x27;</span>, selectedKeys, e)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123; <span class="attr">selectedKey</span>: selectedKeys[<span class="number">0</span>] &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 由数组生成Tree</span></span><br><span class="line">  getTreeNode = <span class="function">(<span class="params">treeContent</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!treeContent || treeContent.<span class="property">length</span> === <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> treeNode = treeContent.<span class="title function_">map</span>(<span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (value.<span class="property">id</span> === <span class="string">&#x27;all&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">          <span class="language-xml"><span class="tag">&lt;<span class="name">TreeNode</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">title</span>=<span class="string">&#123;</span>&lt;<span class="attr">div</span>&gt;</span><span class="tag">&lt;<span class="name">Icon</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">marginRight:</span> &#x27;<span class="attr">5px</span>&#x27; &#125;&#125; <span class="attr">type</span>=<span class="string">&quot;folder-open&quot;</span> /&gt;</span>&#123;value.title&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span>&#125;</span></span><br><span class="line"><span class="language-xml">            key=&#123;value.key&#125;</span></span><br><span class="line"><span class="language-xml">          &gt;</span></span><br><span class="line"><span class="language-xml">            &#123;this.getTreeNode(value.children)&#125;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">TreeNode</span>&gt;</span></span>)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">TreeNode</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">draggable</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">title</span>=<span class="string">&#123;</span> &lt;<span class="attr">span</span>&gt;</span>&#123;value.title&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span>&#125;</span></span><br><span class="line"><span class="language-xml">          key=&#123;value.key&#125;</span></span><br><span class="line"><span class="language-xml">        &gt;</span></span><br><span class="line"><span class="language-xml">          &#123;this.getTreeNode(value.children)&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">TreeNode</span>&gt;</span></span></span><br><span class="line">      )</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      treeNode</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">  setItemKeys = <span class="function">(<span class="params">Item</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title class_">Item</span> = <span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123;&#125;, <span class="title class_">Item</span>, &#123;<span class="attr">key</span>: <span class="title class_">Item</span>.<span class="property">id</span> + <span class="title class_">Date</span>.<span class="title function_">now</span>()&#125;)</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title class_">Item</span>.<span class="property">children</span> || <span class="title class_">Item</span>.<span class="property">children</span>.<span class="property">length</span> === <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">Item</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> children = <span class="title class_">Item</span>.<span class="property">children</span>.<span class="title function_">map</span>(<span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">setItemKeys</span>(value)</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">const</span> ret = <span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123;&#125;, <span class="title class_">Item</span>, &#123;children&#125;)</span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 新增Item</span></span><br><span class="line">  addItem = <span class="function">(<span class="params">Item</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 为新加Item设置新的key</span></span><br><span class="line">    <span class="keyword">let</span> &#123; treeContent &#125; = <span class="variable language_">this</span>.<span class="property">state</span></span><br><span class="line">    <span class="title class_">Item</span>= <span class="variable language_">this</span>.<span class="title function_">setItemKeys</span>(<span class="title class_">Item</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;new key:&#x27;</span>, <span class="title class_">Item</span>.<span class="property">key</span>)</span><br><span class="line">    treeContent.<span class="title function_">push</span>(<span class="title class_">Item</span>)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123; treeContent &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; treeContent &#125; = <span class="variable language_">this</span>.<span class="property">state</span></span><br><span class="line">    <span class="keyword">const</span> treeNodes = <span class="variable language_">this</span>.<span class="title function_">getTreeNode</span>(treeContent)</span><br><span class="line">    <span class="keyword">const</span> &#123; connectDropTarget &#125; = <span class="variable language_">this</span>.<span class="property">props</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">connectDropTarget</span>(</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">style</span>=<span class="string">&#123;&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">float:</span> &quot;<span class="attr">left</span>&quot;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">minHeight:</span> &#x27;<span class="attr">500px</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">border:</span> &#x27;<span class="attr">1px</span> <span class="attr">solid</span> <span class="attr">red</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">marginLeft:</span> &#x27;<span class="attr">50px</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">marginRight:</span> &#x27;<span class="attr">100px</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">padding:</span> &#x27;<span class="attr">20px</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &gt;</span></span></span><br><span class="line"><span class="language-xml">        我可以接收drag、且本地可以排序的</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Tree</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">draggable</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">draggable</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">onDragEnter</span>=<span class="string">&#123;this.onDragEnter&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">onDrop</span>=<span class="string">&#123;this.onDrop&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">onSelect</span>=<span class="string">&#123;this.onNodeSelect&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &gt;</span></span></span><br><span class="line"><span class="language-xml">            &#123;treeNodes&#125;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">Tree</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> spec = &#123;</span><br><span class="line">  <span class="comment">// monitor.getItem()可获取之前dragsource在beginDrag中return的Object</span></span><br><span class="line">  <span class="comment">//component可直接调用组件内部方法</span></span><br><span class="line">  drop (props, monitor, component) &#123;</span><br><span class="line">    component.<span class="title function_">addItem</span>(monitor.<span class="title function_">getItem</span>())</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">collect</span> (connect, monitor) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">connectDropTarget</span>: connect.<span class="title function_">dropTarget</span>(),</span><br><span class="line">    <span class="attr">isOver</span>: monitor.<span class="title function_">isOver</span>(),</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">DropTarget</span>(<span class="string">&#x27;hahaha&#x27;</span>, spec, collect)(<span class="title class_">DragT</span>)</span><br></pre></td></tr></table></figure>
    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/React/" rel="tag"># React</a>
              <a href="/tags/Drag-dnd/" rel="tag"># Drag-dnd</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2017/09/20/front-end/basic/htmlEvent/" rel="prev" title="前端事件机制">
      <i class="fa fa-chevron-left"></i> 前端事件机制
    </a></div>
      <div class="post-nav-item">
    <a href="/2017/09/24/front-end/advance/echarts%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93/" rel="next" title="在React中使用echarts">
      在React中使用echarts <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="gitalk-container"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%A6%82%E8%BF%B0"><span class="nav-number">1.</span> <span class="nav-text">概述</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BA%90%E7%A0%81%E5%9C%B0%E5%9D%80"><span class="nav-number">1.1.</span> <span class="nav-text">源码地址</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%B7%A5%E5%85%B7"><span class="nav-number">1.2.</span> <span class="nav-text">使用工具:</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%9E%E7%8E%B0%E8%AF%A6%E8%A7%A3"><span class="nav-number">2.</span> <span class="nav-text">实现详解</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#React-dnd%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-number">2.1.</span> <span class="nav-text">React-dnd的使用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#DragSource"><span class="nav-number">2.1.1.</span> <span class="nav-text">DragSource</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%82%E6%95%B0%E8%AE%B2%E8%A7%A3"><span class="nav-number">2.1.1.1.</span> <span class="nav-text">参数讲解:</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#type"><span class="nav-number">2.1.1.2.</span> <span class="nav-text">type</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#spec"><span class="nav-number">2.1.1.3.</span> <span class="nav-text">spec</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8F%82%E6%95%B0%E8%AE%B2%E8%A7%A3%EF%BC%9A"><span class="nav-number">2.1.1.3.1.</span> <span class="nav-text">参数讲解：</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%85%B7%E4%BD%93%E5%8F%AF%E7%94%A8%E6%96%B9%E6%B3%95"><span class="nav-number">2.1.1.3.2.</span> <span class="nav-text">具体可用方法:</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#collect"><span class="nav-number">2.1.1.4.</span> <span class="nav-text">collect</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B"><span class="nav-number">2.1.1.4.1.</span> <span class="nav-text">示例</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#options"><span class="nav-number">2.1.1.5.</span> <span class="nav-text">options</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DropTarget"><span class="nav-number">2.1.2.</span> <span class="nav-text">DropTarget</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#types"><span class="nav-number">2.1.2.1.</span> <span class="nav-text">types</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#spec-1"><span class="nav-number">2.1.2.2.</span> <span class="nav-text">spec</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#tips"><span class="nav-number">2.2.</span> <span class="nav-text">tips</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Antd-Tree%E7%9A%84%E6%8E%92%E5%BA%8F%E5%AE%9E%E7%8E%B0"><span class="nav-number">2.3.</span> <span class="nav-text">Antd Tree的排序实现</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">vonxq</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">58</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">17</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">vonxq</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : '3c0d3faa413e82965f95',
      clientSecret: '8207859f32e641615e3a46c6aa26b811b0f4fbe7',
      repo        : 'vonxq.github.io',
      owner       : 'vonxq',
      admin       : ['vonxq'],
      id          : '03f44f55dda2b90a5b88499b7a08a6e6',
        language: 'zh-CN',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script>

</body>
</html>
